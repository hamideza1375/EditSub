<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <form onsubmit="sendFile(event)">
        <input accept="video/*" type="file" /><br>
        <input type="submit" />
    </form>
    <video style="margin-left: 20px; width: calc(100% - 40px);" autoplay muted controls>
        <source type="video/mp4" />
    </video>
    <div id="divScroll" style="height: 100px; width: 360px; margin: 0 auto;">
        <p id="p" style="font-size: 16px; line-height: 2; font-weight: 600; padding: 10px; text-align: justify;"></p>
    </div>
</body>
<script src="./public/axios.js"></script>
<script>
    let count = 20, int
    async function sendFile(event) {
        event.preventDefault();
        const fData = new FormData();
        fData.append('video', document.querySelector('input').files[0]);
        const { status, data } = await axios.post('http://localhost:4000/upload', fData, { headers: { "Content-Type": "multipart/form-data", } })
        if (status === 200) {
            document.getElementById('p').innerHTML = data.text
            document.querySelector('video').src = "http://localhost:4000/" + data.videoUrl
        }
    }

    document.getElementById('divScroll').onscroll = () => {
        count = document.getElementById('divScroll').scrollTop
    }

    document.querySelector('video').onplay = () => {
        document.getElementById('divScroll').style.overflowY = 'scroll'
        count = document.getElementById('divScroll').scrollTop
        int = setInterval(() => {
            document.getElementById('divScroll').scrollTo(0, count)
            count += 20
            if (count >= document.getElementById('divScroll').scrollHeight) { clearInterval(int) }
        }, 3000);
    }
    
    document.querySelector('video').onpause = () => { if (int && !document.querySelector('video').ended) clearInterval(int) }

</script>

</html>